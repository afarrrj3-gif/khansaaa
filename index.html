<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IP Chat Perfect</title>
</head>

<body style="
margin:0;
height:100vh;
display:flex;
flex-direction:column;
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:url('https://res.cloudinary.com/dtdodhqqi/image/upload/v1771310542/c36725a5a2a254a5df8c7dd4bdaa05af_v3tzna.jpg');
background-size:cover;
background-position:center;
">

<!-- CHAT AREA -->
<div id="chatArea" style="
flex:1;
overflow-y:auto;
padding:15px;
display:flex;
flex-direction:column;
gap:8px;
"></div>

<!-- FILE INPUT -->
<input type="file" id="fileInput" accept="image/*" style="display:none">

<!-- ========================= -->
<!-- KOLOM KETIK (TIDAK DIUBAH) -->
<!-- ========================= -->

<div style="padding:10px 12px;">

<div style="
display:flex;
align-items:center;
background:#1f2c34;
border-radius:999px;
height:44px;
padding:0 12px;
box-shadow:
0 4px 12px rgba(0,0,0,0.45),
inset 0 1px 0 rgba(255,255,255,0.05);
">

<!-- EMOJI -->
<svg onclick="addEmoji()" viewBox="0 0 24 24"
fill="none"
stroke="#2AABEE"
stroke-width="2"
stroke-linecap="round"
stroke-linejoin="round"
style="
width:24px;
height:24px;
transform:scale(1.8);
margin-right:16px;
cursor:pointer;">
<circle cx="12" cy="12" r="9"/>
<circle cx="9" cy="10" r="0.8" fill="#2AABEE" stroke="none"/>
<circle cx="15" cy="10" r="0.8" fill="#2AABEE" stroke="none"/>
<path d="M8 14c2.2 2.4 5.8 2.4 8 0"/>
</svg>

<!-- INPUT -->
<input id="msgInput" type="text" placeholder="Message"
style="
flex:1;
border:none;
outline:none;
background:transparent;
color:white;
font-size:16px;
height:100%;
">

<!-- ATTACH -->
<svg onclick="document.getElementById('fileInput').click()" viewBox="0 0 24 24"
fill="none"
stroke="#2AABEE"
stroke-width="2"
stroke-linecap="round"
stroke-linejoin="round"
style="
width:24px;
height:24px;
transform:scale(1.8);
margin-right:8px;
cursor:pointer;">
<path d="M7 13l6-6a3 3 0 114 4l-8 8a5 5 0 11-7-7l9-9"/>
</svg>

<!-- SEND -->
<div onclick="sendMessage()" style="
width:44px;
height:44px;
min-width:44px;
min-height:44px;
flex-shrink:0;
background:#2AABEE;
border-radius:50%;
display:flex;
justify-content:center;
align-items:center;
cursor:pointer;
box-shadow:0 4px 12px rgba(0,0,0,0.4);
">

<svg width="22" height="22" viewBox="0 0 24 24" fill="white">
<path d="M3 20l18-8-18-8v6l13 2-13 2z"/>
</svg>

</div>

</div>
</div>

<script>

const chatArea = document.getElementById("chatArea");
const input = document.getElementById("msgInput");
const fileInput = document.getElementById("fileInput");

function getTime(){
const d = new Date();
return d.getHours().toString().padStart(2,'0') + ":" +
d.getMinutes().toString().padStart(2,'0');
}

function sendMessage(){
if(input.value.trim()==="") return;
createBubble(input.value);
input.value="";
}

function createBubble(text, isImage=false){

const bubble = document.createElement("div");
bubble.style.alignSelf="flex-end";
bubble.style.background="#2AABEE";
bubble.style.color="white";
bubble.style.padding="8px 10px";
bubble.style.borderRadius="14px";
bubble.style.maxWidth="75%";
bubble.style.fontSize="14px";
bubble.style.wordWrap="break-word";
bubble.style.border="1px solid rgba(255,255,255,0.1)";

if(isImage){
const img=document.createElement("img");
img.src=text;
img.style.width="100%";
img.style.borderRadius="10px";
bubble.appendChild(img);
}else{
bubble.innerHTML=text;
}

const meta=document.createElement("div");
meta.style.fontSize="10px";
meta.style.marginTop="4px";
meta.innerHTML=getTime()+
` <span class="check" style="color:gray">âœ”âœ”</span>`;

bubble.appendChild(meta);
chatArea.appendChild(bubble);
chatArea.scrollTop=chatArea.scrollHeight;

setTimeout(()=>{
meta.querySelector(".check").style.color="#00BFFF";
},2000);

// LONG PRESS
let pressTimer;
bubble.onmousedown=()=>{pressTimer=setTimeout(()=>showPopup(bubble),500);}
bubble.onmouseup=()=>clearTimeout(pressTimer);
}

fileInput.onchange=function(e){
const reader=new FileReader();
reader.onload=function(){
createBubble(reader.result,true);
}
reader.readAsDataURL(e.target.files[0]);
}

function showPopup(bubble){
const popup=document.createElement("div");
popup.style.position="fixed";
popup.style.bottom="100px";
popup.style.left="50%";
popup.style.transform="translateX(-50%)";
popup.style.background="white";
popup.style.borderRadius="12px";
popup.style.padding="10px";
popup.style.width="200px";
popup.style.textAlign="center";

popup.innerHTML=`
<div onclick="deleteMsg()" style="padding:8px;color:red;">Delete</div>
<hr>
<div onclick="editMsg()" style="padding:8px;">Edit</div>
<hr>
<div onclick="closePopup()" style="padding:8px;">Batal</div>
`;

document.body.appendChild(popup);
window.currentBubble=bubble;
window.currentPopup=popup;
}

function closePopup(){
document.body.removeChild(window.currentPopup);
}

function deleteMsg(){
window.currentBubble.innerHTML="Pesan telah dihapus";
closePopup();
}

function editMsg(){
const text=prompt("Edit pesan:");
if(text){
window.currentBubble.innerHTML=text;
}
closePopup();
}

function addEmoji(){
input.value+="ðŸ˜­";
}

</script>

</body>
</html>
