<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram iOS Final Proper</title>

<style>
body{
margin:0;
height:100vh;
display:flex;
flex-direction:column;
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:url('https://res.cloudinary.com/dtdodhqqi/image/upload/v1771310542/c36725a5a2a254a5df8c7dd4bdaa05af_v3tzna.jpg') center/cover no-repeat;
}

*{-webkit-user-select:none;user-select:none;}

#chatArea{
flex:1;
overflow-y:auto;
padding:12px;
display:flex;
flex-direction:column;
gap:4px;
}

@keyframes bubbleIn{
0%{transform:translateY(8px) scale(.96);opacity:0;}
100%{transform:translateY(0) scale(1);opacity:1;}
}

@keyframes collapse{
0%{opacity:1;max-height:200px;}
100%{opacity:0;max-height:0;}
}

@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}

/* ===== BUBBLE ===== */
.bubble{
align-self:flex-end;
background:#248C46;
color:white;
border-radius:18px;
max-width:75%;
display:inline-flex;
flex-wrap:wrap;
align-items:flex-end;
padding:8px 12px;
animation:bubbleIn .25s cubic-bezier(.34,1.56,.64,1);
position:relative;
overflow:hidden;
font-size:14px;
}

.bubble.image{
padding:0;
border:1px solid rgba(255,255,255,.18);
}

.bubble.image img{
width:100%;
display:block;
}

.meta{
font-size:11px;
opacity:.9;
margin-left:6px;
white-space:nowrap;
display:flex;
align-items:center;
gap:3px;
}

.meta.image{
position:absolute;
right:8px;
bottom:6px;
background:rgba(0,0,0,.45);
padding:2px 6px;
border-radius:10px;
}

.check{
color:rgba(255,255,255,.6);
transition:color .3s;
}

.deleted{
opacity:.6;
font-style:italic;
font-size:13px;
}

/* ===== INPUT BAR (TIDAK DIUBAH STRUKTUR) ===== */
.inputWrap{
padding:10px 12px;
position:relative;
z-index:5;
}

.inputInner{
display:flex;
align-items:center;
background:#1f2c34;
border-radius:999px;
height:44px;
padding:0 12px;
box-shadow:0 4px 12px rgba(0,0,0,.4);
}

.inputInner input{
flex:1;
border:none;
outline:none;
background:transparent;
color:white;
font-size:16px;
}

/* ===== EMOJI PANEL ===== */
#emojiPanel{
display:none;
background:rgba(0,0,0,.6);
backdrop-filter:blur(12px);
padding:12px;
animation:bubbleIn .2s ease;
}

/* ===== OVERLAY ===== */
#overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,.5);
backdrop-filter:blur(12px);
display:none;
z-index:20;
}

/* ===== MENU ===== */
.menu{
position:fixed;
left:50%;
top:50%;
transform:translate(-50%,-50%);
background:rgba(28,28,30,.95);
color:white;
border-radius:18px;
padding:12px;
width:220px;
z-index:30;
animation:fadeIn .2s;
}

/* ===== VIEWER ===== */
#viewer{
position:fixed;
inset:0;
display:none;
justify-content:center;
align-items:center;
flex-direction:column;
background:rgba(0,0,0,.9);
z-index:40;
animation:fadeIn .2s;
}

#viewer img{
max-width:90%;
max-height:70%;
border-radius:16px;
}

.viewerBtn{
margin-top:12px;
padding:10px 20px;
border:none;
border-radius:14px;
background:#1c1c1e;
color:white;
font-size:14px;
}
</style>
</head>

<body oncontextmenu="return false">

<div id="chatArea"></div>
<input type="file" id="fileInput" accept="image/*" style="display:none">

<!-- INPUT -->
<div class="inputWrap">
<div class="inputInner">

<!-- EMOJI SVG ICON -->
<svg onclick="toggleEmoji()" viewBox="0 0 24 24"
fill="none" stroke="#2AABEE" stroke-width="2"
stroke-linecap="round" stroke-linejoin="round"
style="width:22px;height:22px;margin-right:14px;cursor:pointer;">
<circle cx="12" cy="12" r="9"/>
<circle cx="9" cy="10" r="1" fill="#2AABEE" stroke="none"/>
<circle cx="15" cy="10" r="1" fill="#2AABEE" stroke="none"/>
<path d="M8 14c2 2 6 2 8 0"/>
</svg>

<input id="msgInput" placeholder="Message">

<!-- ATTACH SVG -->
<svg onclick="fileInput.click()" viewBox="0 0 24 24"
fill="none" stroke="#2AABEE" stroke-width="2"
stroke-linecap="round" stroke-linejoin="round"
style="width:22px;height:22px;margin:0 10px;cursor:pointer;">
<path d="M7 13l6-6a3 3 0 114 4l-8 8a5 5 0 11-7-7l9-9"/>
</svg>

<!-- SEND -->
<div onclick="sendMessage()" style="width:40px;height:40px;background:#2AABEE;border-radius:50%;display:flex;justify-content:center;align-items:center;cursor:pointer;">
<svg width="18" height="18" viewBox="0 0 24 24" fill="white">
<path d="M3 20l18-8-18-8v6l13 2-13 2z"/>
</svg>
</div>

</div>
</div>

<div id="emojiPanel">
<span onclick="addEmoji('üòÇ')" style="font-size:24px;margin:6px;">üòÇ</span>
<span onclick="addEmoji('üò≠')" style="font-size:24px;margin:6px;">üò≠</span>
<span onclick="addEmoji('‚ù§Ô∏è')" style="font-size:24px;margin:6px;">‚ù§Ô∏è</span>
<span onclick="addEmoji('üî•')" style="font-size:24px;margin:6px;">üî•</span>
</div>

<div id="overlay"></div>

<div id="viewer">
<img id="viewerImg">
<button class="viewerBtn" onclick="saveImage()">Simpan</button>
<button class="viewerBtn" onclick="closeViewer()">Tutup</button>
</div>

<script>
const chatArea=document.getElementById("chatArea");
const input=document.getElementById("msgInput");
const fileInput=document.getElementById("fileInput");
const overlay=document.getElementById("overlay");
const viewer=document.getElementById("viewer");
const viewerImg=document.getElementById("viewerImg");

function getTime(){
const d=new Date();
return d.getHours().toString().padStart(2,'0')+":"+d.getMinutes().toString().padStart(2,'0');
}

function sendMessage(){
if(!input.value.trim()) return;
createBubble(input.value,false);
input.value="";
}

function createBubble(content,isImage){
const bubble=document.createElement("div");
bubble.className="bubble"+(isImage?" image":"");

if(isImage){
const img=document.createElement("img");
img.src=content;
img.onclick=()=>openViewer(content);
bubble.appendChild(img);
}else{
bubble.textContent=content;
}

const meta=document.createElement("div");
meta.className="meta"+(isImage?" image":"");
meta.innerHTML=`<span>${getTime()}</span> <span class="check">‚úî‚úî</span>`;
bubble.appendChild(meta);

chatArea.appendChild(bubble);
chatArea.scrollTop=chatArea.scrollHeight;

/* Check anim only */
setTimeout(()=>meta.querySelector(".check").style.color="#4FC3F7",2000);

/* Long press */
let timer;
bubble.addEventListener("pointerdown",()=>{timer=setTimeout(()=>showMenu(bubble),400);});
bubble.addEventListener("pointerup",()=>clearTimeout(timer));
}

fileInput.onchange=function(e){
const reader=new FileReader();
reader.onload=function(){createBubble(reader.result,true);}
reader.readAsDataURL(e.target.files[0]);
}

function showMenu(bubble){
overlay.style.display="block";
const menu=document.createElement("div");
menu.className="menu";
menu.innerHTML=`
<div onclick="deleteMsg()" style="padding:10px;color:#ff453a;">Delete</div>
<hr style="border:.5px solid rgba(255,255,255,.2);">
<div onclick="editMsg()" style="padding:10px;">Edit</div>
<hr style="border:.5px solid rgba(255,255,255,.2);">
<div onclick="closeMenu()" style="padding:10px;">Batal</div>
`;
document.body.appendChild(menu);
window.currentBubble=bubble;
window.currentMenu=menu;
}

function closeMenu(){
overlay.style.display="none";
if(window.currentMenu) window.currentMenu.remove();
}

function deleteMsg(){
const b=window.currentBubble;
b.style.animation="collapse .25s forwards";
setTimeout(()=>{
b.innerHTML="<div class='deleted'>Pesan telah dihapus</div>";
b.style.animation="fadeIn .2s";
},250);
closeMenu();
}

function editMsg(){
const t=prompt("Edit pesan:");
if(t) window.currentBubble.firstChild.textContent=t;
closeMenu();
}

function toggleEmoji(){
emojiPanel.style.display=emojiPanel.style.display==="block"?"none":"block";
}

function addEmoji(e){input.value+=e;}

function openViewer(src){
viewer.style.display="flex";
overlay.style.display="block";
viewerImg.src=src;
}

function closeViewer(){
viewer.style.display="none";
overlay.style.display="none";
}

function saveImage(){
const a=document.createElement("a");
a.href=viewerImg.src;
a.download="image.jpg";
a.click();
}
</script>

</body>
</html>
